<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MisFavoritos - P√°gina de Inicio</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ====== ESTILOS GENERALES ====== */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #1a2a6c;
      color: white;
    }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      z-index: 1;
      pointer-events: none;
    }
    .container {
      position: relative;
      z-index: 2;
      padding: 20px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo {
      font-size: 2rem;
      color: white;
    }
    .controls button {
      margin-left: 10px;
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    /* ====== TABS ====== */
    #tabsList {
      margin-top: 20px;
    }
    .tab {
      padding: 10px;
      cursor: pointer;
      display: inline-block;
      margin: 5px;
      background: #333;
      color: white;
      border-radius: 5px;
    }
    .tab.active { background: #555; }
    .tab-content {
      display: none;
      padding: 20px;
      background: #f9f9f9;
      color: black;
      border-radius: 8px;
      margin-top: 10px;
    }
    .tab-content.active { display: block; }
    /* ====== SHORTCUTS ====== */
    .shortcut {
      display: inline-block;
      padding: 10px;
      background: #ddd;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
    }
    .shortcut:hover { background: #ccc; }
    /* ====== FOOTER ====== */
    .credit {
      margin-top: 30px;
      font-size: 0.8rem;
      text-align: center;
      color: #ccc;
    }
  </style>
</head>
<body>

<div class="overlay"></div>

<div class="container">
  <header>
    <div class="logo"><i class="fas fa-book"></i> Mis<span>Favoritos</span></div>
    <div class="controls">
      <button id="addShortcutBtn">A√±adir Contenido</button>
      <button id="editModeBtn">Editar</button>
      <button id="settingsBtn">Configuraci√≥n</button>
    </div>
  </header>

  <div id="tabsList"></div>
  <div id="tabContents"></div>

  <div class="credit">
    P√°gina de inicio personalizada - MisFavoritos - Cambios guardados en Firebase Firestore
  </div>
</div>

<!-- ================== FIREBASE ================== -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  // ‚ö° Configuraci√≥n real de tu proyecto Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyA0gxgrmWx7pwffdfyw8bqv0TfmzNK7UME",
    authDomain: "misfavoritos-402b0.firebaseapp.com",
    projectId: "misfavoritos-402b0",
    storageBucket: "misfavoritos-402b0.firebasestorage.app",
    messagingSenderId: "115400831622",
    appId: "1:115400831622:web:a63ccaf3d31aba087e5707",
    measurementId: "G-J680EVJ2E2"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ====== VARIABLES ======
  let tabs = [
    {
      id: 1,
      name: "Accesos Directos",
      icon: "fas fa-th",
      active: true,
      content: [
        {
          type: "shortcuts",
          shortcuts: [
            { name: "Outlook Office 365", url: "https://outlook.office.com" },
            { name: "Drive", url: "https://drive.google.com" },
            { name: "Gmail", url: "https://gmail.com" },
            { name: "YouTube", url: "https://youtube.com" }
          ]
        }
      ]
    }
  ];

  // ====== FIRESTORE ======
  async function saveTabs() {
    try {
      await setDoc(doc(db, "users", "default"), { tabs });
      console.log("‚úÖ Tabs guardadas en Firestore");
    } catch (err) {
      console.error("‚ùå Error al guardar en Firestore:", err);
    }
  }

  async function loadTabs() {
    try {
      const docSnap = await getDoc(doc(db, "users", "default"));
      if (docSnap.exists()) {
        tabs = docSnap.data().tabs;
        console.log("üì• Tabs cargadas desde Firestore");
      } else {
        console.log("‚ö†Ô∏è No hay datos en Firestore, usando valores por defecto");
      }
    } catch (err) {
      console.error("‚ùå Error al cargar desde Firestore:", err);
    }
    renderTabs();
  }

  // ====== RENDER ======
  function renderTabs() {
    const tabsList = document.getElementById("tabsList");
    const tabContents = document.getElementById("tabContents");
    tabsList.innerHTML = "";
    tabContents.innerHTML = "";

    tabs.forEach(tab => {
      const tabBtn = document.createElement("div");
      tabBtn.className = "tab" + (tab.active ? " active" : "");
      tabBtn.textContent = tab.name;
      tabBtn.addEventListener("click", () => switchTab(tab.id));
      tabsList.appendChild(tabBtn);

      const contentDiv = document.createElement("div");
      contentDiv.className = "tab-content" + (tab.active ? " active" : "");
      contentDiv.id = "tab-" + tab.id;

      tab.content.forEach(item => {
        if (item.type === "shortcuts") {
          const shortcutsDiv = document.createElement("div");
          item.shortcuts.forEach(s => {
            const shortcut = document.createElement("div");
            shortcut.className = "shortcut";
            shortcut.textContent = s.name;
            shortcut.addEventListener("click", () => window.open(s.url, "_blank"));
            shortcutsDiv.appendChild(shortcut);
          });
          contentDiv.appendChild(shortcutsDiv);
        }
      });

      tabContents.appendChild(contentDiv);
    });
  }

  function switchTab(tabId) {
    tabs.forEach(t => t.active = (t.id === tabId));
    saveTabs();
    renderTabs();
  }

  // ====== INIT ======
  document.addEventListener("DOMContentLoaded", () => {
    loadTabs();
  });
</script>
</body>
</html>
